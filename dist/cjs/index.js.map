{"mappings":"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","sources":["src/index.ts","src/util/index.ts","src/util/roomUtils.ts","src/util/varhubParams.ts","src/hook/index.ts","src/hook/useVarhubInitialParams.ts","src/components/index.ts","src/components/VarhubEnterPage.tsx","src/components/Card/Card.tsx","src/components/Loader/Loader.tsx","src/components/parameter/VarhubInputParameter.tsx","src/components/settings/SettingsSection.tsx","src/components/icon/ArrowIcon.tsx","src/components/Button/VarhubButton.tsx","src/components/parameter/VarhubNumberParameter.tsx","src/components/VarhubSelfControlEnterPage.tsx","src/context/VarhubGameClientContext.tsx","src/components/settings/SettingsInputParameter.tsx","src/components/settings/SettingsNumberParameter.tsx","src/components/settings/SettingsSwitchParameter.tsx","src/components/parameter/VarhubSwitchParameter.tsx","src/components/Switch/Switch.tsx","src/context/index.ts"],"sourcesContent":["export * from \"./util\"\r\nexport * from \"./hook\"\r\nexport * from \"./components\"\r\nexport * from \"./context\"","export * from \"./roomUtils\"\r\nexport * from \"./varhubParams\"","import {Varhub, VarhubClient} from \"@flinbein/varhub-web-client\";\r\n\r\nexport interface CreateRoomAndClientOpts {\r\n    serverUrl: string;\r\n    playerName: string;\r\n    roomId?: string;\r\n\r\n    abortController: AbortController;\r\n    settings?: any;\r\n\r\n    importRoomModule: () => Promise<{roomIntegrity: string; roomModule: { main: string, source: Record<string, string>}}>;\r\n    roomIntegrity: string;\r\n}\r\n\r\nexport async function createVarhubRoomAndClient(opts: CreateRoomAndClientOpts){\r\n    const {serverUrl, playerName, abortController, settings = {}, importRoomModule, roomIntegrity} = opts;\r\n\r\n    let roomId = opts.roomId;\r\n\r\n    const hub = new Varhub(serverUrl);\r\n\r\n    if (!roomId) {\r\n        const { roomModule, roomIntegrity} = await importRoomModule();\r\n        const roomData = await hub.createRoom(roomModule, {integrity: roomIntegrity, config: settings});\r\n        roomId = roomData.id;\r\n    }\r\n    return await hub.join(roomId, playerName, {integrity: roomIntegrity, timeout: abortController?.signal}) as any as VarhubClient<any, any>;\r\n}\r\n\r\n","export interface VarhubEnterParams {\r\n    serverUrl?: string;\r\n    roomId?: string;\r\n    playerName?: string;\r\n    autoJoin?: boolean;\r\n    settings?: any;\r\n}\r\n\r\nexport const getVarhubEnterParams = ():VarhubEnterParams  => {\r\n    const searchParams = new URLSearchParams(location.search);\r\n\r\n    const varhubEnterState = JSON.parse(history?.state?.varhubEnterState || \"{}\") as VarhubEnterParams\r\n    const serverUrl = searchParams.get(\"serverUrl\") ?? varhubEnterState.serverUrl ?? undefined;\r\n    const roomId = searchParams.get(\"roomId\") ?? varhubEnterState.roomId ?? undefined;\r\n\r\n    const playerName = varhubEnterState.playerName ?? undefined;\r\n    const settings = varhubEnterState.settings ?? {};\r\n    const autoJoin = varhubEnterState.autoJoin ?? false;\r\n\r\n    return {\r\n        serverUrl, roomId, playerName, autoJoin, settings\r\n    }\r\n}\r\n\r\nexport const saveVarhubEnterParams = (params: VarhubEnterParams) => {\r\n    const currentUrl = new URL(location.href);\r\n    const state = {varhubEnterState: JSON.stringify(params || {})}\r\n    currentUrl.search = \"\";\r\n    history.replaceState(state, \"\", currentUrl);\r\n}","export * from \"./useVarhubInitialParams\"","import {useRef} from \"react\";\r\nimport {getVarhubEnterParams} from \"../util/varhubParams\";\r\n\r\nexport const useVarhubInitialParams = () => {\r\n    return useRef(getVarhubEnterParams()).current\r\n}","export * from \"./VarhubEnterPage\"\r\nexport * from \"./VarhubSelfControlEnterPage\"\r\n\r\nexport * from \"./settings/SettingsInputParameter\";\r\nexport * from \"./settings/SettingsNumberParameter\";\r\nexport * from \"./settings/SettingsSwitchParameter\";","import {FC, PropsWithChildren, useCallback, useEffect, useMemo, useState} from \"react\";\r\nimport {Card} from \"./Card/Card\";\r\nimport {FormProvider, useForm} from \"react-hook-form\";\r\nimport {VarhubInputParameter} from \"./parameter/VarhubInputParameter\";\r\n\r\nimport {SettingsSection} from \"./settings/SettingsSection\";\r\nimport {VarhubButton} from \"./Button/VarhubButton\";\r\nimport {VarhubNumberParameter} from \"./parameter/VarhubNumberParameter\";\r\nimport useLatestCallback from \"use-latest-callback\";\r\nimport cn from \"classnames\";\r\nimport {VarhubEnterParams} from \"../util/varhubParams\";\r\n\r\nconst urlPattern =\r\n    /(https:\\/\\/www\\.|http:\\/\\/www\\.|https:\\/\\/|http:\\/\\/)?[a-zA-Z]{2,}(\\.[a-zA-Z]{2,})(\\.[a-zA-Z]{2,})?\\/[a-zA-Z0-9]{2,}|((https:\\/\\/www\\.|http:\\/\\/www\\.|https:\\/\\/|http:\\/\\/)?[a-zA-Z]{2,}(\\.[a-zA-Z]{2,})(\\.[a-zA-Z]{2,})?)|(https:\\/\\/www\\.|http:\\/\\/www\\.|https:\\/\\/|http:\\/\\/)?[a-zA-Z0-9]{2,}\\.[a-zA-Z0-9]{2,}\\.[a-zA-Z0-9]{2,}(\\.[a-zA-Z0-9]{2,})?/g;\r\n\r\n\r\nexport interface OnEnterRoomOpts {\r\n    joinMode: boolean;\r\n    serverUrl: string;\r\n    roomId: string;\r\n    playerName: string;\r\n    settings?: any;\r\n}\r\n\r\ninterface VarhubEnterPageProps {\r\n    initialParams?: VarhubEnterParams\r\n\r\n    className?: string;\r\n    darkMode?: boolean;\r\n    onEnter?: (opts: OnEnterRoomOpts) => void;\r\n    abortController?: AbortController|null;\r\n}\r\n\r\nexport const VarhubEnterPage: FC<PropsWithChildren<VarhubEnterPageProps>> = (props) => {\r\n    const {children, initialParams, className, darkMode, onEnter, abortController} = props;\r\n\r\n    const [joinMode, setJoinMode] = useState(initialParams?.roomId !== undefined);\r\n    const switchJoinMode = useCallback(() => setJoinMode(v => !v), [setJoinMode])\r\n\r\n    const formMethods = useForm({\r\n        defaultValues: initialParams,\r\n        mode: \"onSubmit\",\r\n        reValidateMode: \"onSubmit\",\r\n        shouldUseNativeValidation: true,\r\n        delayError: 500,\r\n        shouldFocusError: false\r\n    });\r\n\r\n    const onSubmit = useLatestCallback((data) => {\r\n        onEnter?.({\r\n            joinMode: data.roomId === undefined,\r\n            serverUrl: data.serverUrl,\r\n            roomId: data.roomId,\r\n            playerName: data.playerName,\r\n            settings: data.settings\r\n        })\r\n    })\r\n\r\n    useEffect(() => {\r\n        if (!initialParams?.autoJoin) return;\r\n        onSubmit(formMethods.getValues())\r\n    }, [initialParams?.autoJoin])\r\n\r\n    const actions = (\r\n        <>\r\n            <VarhubButton htmlType=\"submit\" disabled={abortController != null}>\r\n                {joinMode ? \"Join room\" : \"Create room\"}\r\n            </VarhubButton>\r\n            <VarhubButton\r\n                type=\"secondary\"\r\n                htmlType=\"button\"\r\n                onClick={switchJoinMode}\r\n                className=\"vh-ml-2\"\r\n                disabled={abortController != null}\r\n            >\r\n                {joinMode ? \"Or create new room\" : \"Or join existing room\"}\r\n            </VarhubButton>\r\n        </>\r\n    )\r\n\r\n    return (\r\n        <div className={cn(\"varhub-page\", className, {\"dark-mode\": darkMode})}>\r\n            <form\r\n                className=\"varhub-form\"\r\n                onSubmit={formMethods.handleSubmit(onSubmit)}\r\n            >\r\n                <Card title={\"SpyFall\"} actions={actions} loading={abortController != null}>\r\n                    <FormProvider {...formMethods}>\r\n                        <VarhubInputParameter\r\n                            required\r\n                            className=\"vh-mt-2\"\r\n                            name=\"serverUrl\"\r\n                            label=\"Varhub server URL\"\r\n                            pattern={urlPattern}\r\n                            patternMessage=\"Invalid url\"\r\n                        />\r\n                        <VarhubInputParameter required className=\"vh-mt-3\" name=\"playerName\" label=\"Player name\"/>\r\n                        {joinMode && <VarhubNumberParameter required min={0} className=\"vh-mt-3\" name=\"roomId\" label=\"Room ID\"/>}\r\n                        {children && !joinMode && (\r\n                            <SettingsSection>\r\n                                {children}\r\n                            </SettingsSection>\r\n                        )}\r\n                    </FormProvider>\r\n                </Card>\r\n            </form>\r\n    </div>\r\n    )\r\n}","import {FC, PropsWithChildren, ReactNode} from \"react\";\r\nimport cn from \"classnames\";\r\nimport {Loader} from \"../Loader/Loader\";\r\n\r\nimport \"./Card.css\";\r\n\r\ninterface CardProps {\r\n    title: string;\r\n    actions?: ReactNode\r\n    loading?: boolean;\r\n}\r\n\r\nexport const Card: FC<PropsWithChildren<CardProps>> = (props) => {\r\n    const {children, title, actions, loading} = props;\r\n\r\n    return (\r\n        <div className={cn(\"varhub-card\")}>\r\n            <div className=\"varhub-card__content varhub-card__header\">\r\n                <h2 className=\"varhub-card__header__text\">{title}</h2>\r\n                {loading && <Loader size={24}/>}\r\n            </div>\r\n            <div className=\"varhub-card__content varhub-card__body\">\r\n                {children}\r\n            </div>\r\n\r\n            {actions && (\r\n                <div className=\"varhub-card__content varhub-card__actions varhub-card__divider--top\">\r\n                    {actions}\r\n                </div>\r\n            )}\r\n\r\n            <div className=\"varhub-card__powered-by varhub-card__content varhub-card__divider--top\">\r\n                Powered by <a className=\"varhub-card__link\" href=\"https://github.com/flinbein/varhub-web-server\">VarHub</a>\r\n            </div>\r\n        </div>\r\n    )\r\n}","import {FC} from \"react\";\r\nimport \"./Loader.css\"\r\n\r\ninterface LoaderProps {\r\n    size: number;\r\n}\r\n\r\nexport const Loader: FC<LoaderProps> = ({size}) => {\r\n    return (\r\n        <span className=\"vh-loader\" style={{height: size, width: size}}></span>\r\n    )\r\n}","import {useFormContext} from \"react-hook-form\";\r\nimport {FC, useMemo} from \"react\";\r\nimport cn from \"classnames\"\r\n\r\nimport \"./VarhubParameter.css\"\r\n\r\nexport interface VarhubInputParameterProps {\r\n    name: string;\r\n    placeholder?: string;\r\n    label?: string;\r\n    className?: string;\r\n    required?: boolean;\r\n    pattern?: RegExp\r\n    patternMessage?: string;\r\n}\r\n\r\nexport const VarhubInputParameter: FC<VarhubInputParameterProps> = (props) => {\r\n    const {\r\n        name,\r\n        placeholder,\r\n        label = props.name,\r\n        className = \"vh-mt-3\",\r\n        required= false,\r\n        pattern,\r\n        patternMessage\r\n    } = props;\r\n    const { register} = useFormContext() // retrieve all hook methods\r\n\r\n    const patternValidation = useMemo(() => {\r\n        if (!pattern) return undefined;\r\n        return {value: pattern, message: patternMessage || \"Invalid pattern\"}\r\n    }, [pattern, patternMessage])\r\n\r\n    return (\r\n        <div className={cn(\"varhub-parameter-input\", className)}>\r\n            <input placeholder={placeholder} type=\"text\" required={required} {...register(name, {shouldUnregister: true, required, pattern: patternValidation })}/>\r\n            <label>{label}</label>\r\n        </div>\r\n    )\r\n}","import {FC, PropsWithChildren, useCallback, useState} from \"react\";\r\n\r\nimport \"./Settings.css\";\r\nimport {ArrowIcon} from \"../icon/ArrowIcon\";\r\nimport cn from \"classnames\";\r\n\r\nexport const SettingsSection: FC<PropsWithChildren> = ({children}) => {\r\n\r\n    const [expanded, setExpanded] = useState(false);\r\n\r\n    const onSwitchExpand = useCallback(() => {\r\n        setExpanded(v => !v);\r\n    }, [setExpanded])\r\n\r\n    return (\r\n        <div className=\"vh-settings-section varhub-card__divider--top\">\r\n            <h5 className=\"vh-settings-section__title\">\r\n                Settings\r\n                <a\r\n                    className={cn(\"vh-settings-section__title__button\", {reversed: expanded})}\r\n                    onClick={onSwitchExpand}\r\n                    type=\"button\"\r\n                >\r\n                    <ArrowIcon direction=\"down\"/>\r\n                </a>\r\n            </h5>\r\n            <div className={`vh-settings-section__body ${expanded ? \"shown\" : \"hidden\"}`}>\r\n                {children}\r\n            </div>\r\n        </div>\r\n    )\r\n}","import {FC} from \"react\";\r\n\r\nimport \"./ArrowIcon.css\"\r\nimport cn from \"classnames\";\r\n\r\ninterface ArrowIconProps {\r\n    direction: \"left\" | \"right\" | \"up\" | \"down\";\r\n}\r\n\r\nexport const ArrowIcon: FC<ArrowIconProps> = ({direction}) => {\r\n\r\n    return (\r\n        <i className={cn(\"vh-arrow\", direction)}></i>\r\n    )\r\n}","import {ButtonHTMLAttributes, FC, PropsWithChildren} from \"react\";\r\nimport cn from \"classnames\";\r\n\r\nimport \"./VarhubButton.css\"\r\n\r\ninterface VarhubButtonProps {\r\n    className?: string;\r\n    role?: ButtonHTMLAttributes<any>[\"role\"];\r\n    htmlType?: ButtonHTMLAttributes<any>[\"type\"];\r\n    onClick?: ButtonHTMLAttributes<any>[\"onClick\"];\r\n    type?: string\r\n    disabled?: boolean;\r\n}\r\n\r\nexport const VarhubButton: FC<PropsWithChildren<VarhubButtonProps>> = (props) => {\r\n    const {\r\n        children,\r\n        htmlType,\r\n        type = \"primary\",\r\n        className,\r\n        onClick,\r\n        disabled,\r\n        ...rest\r\n    } = props;\r\n\r\n    const handledOnChange = (e) => {\r\n        if (disabled) {\r\n            return;\r\n        }\r\n        onClick?.(e);\r\n    }\r\n\r\n    return (\r\n        <button\r\n            type={htmlType}\r\n            {...rest}\r\n            onClick={handledOnChange}\r\n            disabled={disabled}\r\n            className={cn(\"varhub-button\", className, {[`type-${type}`]: type})}\r\n        >\r\n            {children}\r\n        </button>\r\n    )\r\n}\r\n\r\n","import {useFormContext} from \"react-hook-form\";\r\nimport {FC, useCallback} from \"react\";\r\nimport cn from \"classnames\"\r\n\r\nimport \"./VarhubParameter.css\"\r\n\r\nexport interface VarhubNumberParameterProps {\r\n    name: string;\r\n    placeholder?: string;\r\n    label?: string;\r\n    className?: string;\r\n\r\n    required?: boolean;\r\n    min?: number;\r\n    max?: number;\r\n}\r\n\r\nexport const VarhubNumberParameter: FC<VarhubNumberParameterProps> = (props) => {\r\n    const {\r\n        name,\r\n        placeholder,\r\n        label = props.name,\r\n        className = \"vh-mt-3\",\r\n        min,\r\n        max,\r\n        required = false,\r\n    } = props;\r\n    const { register} = useFormContext() // retrieve all hook methods\r\n\r\n    const setValueAs = useCallback((v) => {\r\n        const intValue = parseInt(v);\r\n        if (isNaN(intValue)) return undefined;\r\n        return intValue;\r\n    }, [])\r\n\r\n    return (\r\n        <div className={cn(\"varhub-parameter-input\", className)}>\r\n            <input\r\n                placeholder={placeholder}\r\n                type=\"number\"\r\n                min={min}\r\n                max={max}\r\n                {...register(name, {min, max, shouldUnregister: true, required, setValueAs})}\r\n            />\r\n            <label>{label}</label>\r\n        </div>\r\n    )\r\n}","import {FC, PropsWithChildren, useCallback, useContext, useState} from \"react\";\r\nimport {OnEnterRoomOpts, VarhubEnterPage} from \"./VarhubEnterPage\";\r\nimport {useVarhubInitialParams} from \"../hook/useVarhubInitialParams\";\r\nimport {CreateRoomAndClientOpts, createVarhubRoomAndClient} from \"../util/roomUtils\";\r\nimport type {VarhubClient} from \"@flinbein/varhub-web-client\";\r\nimport {saveVarhubEnterParams} from \"../util/varhubParams\";\r\nimport {VarhubGameClientContext} from \"../context/VarhubGameClientContext\";\r\n\r\ninterface VarhubSelfControlEnterPageProps {\r\n    darkMode?: boolean;\r\n    roomIntegrity: string;\r\n    importRoomModule: CreateRoomAndClientOpts[\"importRoomModule\"]\r\n    onEnter?: (client: VarhubClient) => void;\r\n}\r\n\r\nexport const VarhubSelfControlEnterPage: FC<PropsWithChildren<VarhubSelfControlEnterPageProps>> = (props) => {\r\n    const {roomIntegrity, importRoomModule, onEnter, children, darkMode} = props;\r\n\r\n    const params = useVarhubInitialParams();\r\n    const ctx = useContext(VarhubGameClientContext);\r\n    const [abortController, setAbortController] = useState<AbortController|null>(null);\r\n\r\n    const onEnterPage = useCallback(async (params: OnEnterRoomOpts) => {\r\n        const abortController = new AbortController();\r\n        setAbortController(abortController);\r\n        const client = await createVarhubRoomAndClient({\r\n            ...params,\r\n            roomIntegrity,\r\n            importRoomModule,\r\n            abortController\r\n        });\r\n        setAbortController(null);\r\n        onEnter(client);\r\n        ctx.setClient(client)\r\n        saveVarhubEnterParams({\r\n            ...params,\r\n            roomId: client.roomId,\r\n            autoJoin: true\r\n        })\r\n    }, [onEnter])\r\n\r\n    return (\r\n        <VarhubEnterPage\r\n            darkMode={darkMode}\r\n            initialParams={params}\r\n            onEnter={onEnterPage}\r\n            abortController={abortController}\r\n        >\r\n            {children}\r\n        </VarhubEnterPage>\r\n    )\r\n}","import {createContext, FC, PropsWithChildren, useContext, useMemo, useState} from \"react\";\r\nimport type {VarhubClient} from \"@flinbein/varhub-web-client\";\r\n\r\ninterface IVarhubGameClientContext {\r\n    client: VarhubClient<any, any>|null;\r\n    setClient: (client: VarhubClient<any, any>) => void;\r\n}\r\n\r\nexport const VarhubGameClientContext = createContext<IVarhubGameClientContext>(null as any);\r\n\r\nexport const VarhubGameClientProvider: FC<PropsWithChildren> = ({children}) => {\r\n    const [client, setClient] = useState< VarhubClient<any, any> | null >(null);\r\n\r\n    const ctxValue = useMemo(() => ({client, setClient}), [client, setClient])\r\n\r\n    return (\r\n        <VarhubGameClientContext.Provider value={ctxValue}>\r\n            {children}\r\n        </VarhubGameClientContext.Provider>\r\n    )\r\n}\r\n\r\nexport const useVarhubGameClient = <CLIENT extends VarhubClient>(): CLIENT|null => {\r\n    return useContext(VarhubGameClientContext).client as CLIENT|null;\r\n}","import {FC} from \"react\";\r\nimport {VarhubInputParameter, VarhubInputParameterProps} from \"../parameter/VarhubInputParameter\";\r\n\r\n\r\nexport const SettingsInputParameter: FC<VarhubInputParameterProps> = (props) => {\r\n\r\n    return (\r\n        <VarhubInputParameter {...props} name={\"settings.\"+props.name}/>\r\n    )\r\n}","import {FC} from \"react\";\r\nimport {VarhubNumberParameter, VarhubNumberParameterProps} from \"../parameter/VarhubNumberParameter\";\r\n\r\n\r\nexport const SettingsNumberParameter: FC<VarhubNumberParameterProps> = (props) => {\r\n\r\n    return (\r\n        <VarhubNumberParameter {...props} name={\"settings.\"+props.name}/>\r\n    )\r\n}","import {FC} from \"react\";\r\nimport {VarhubSwitchParameter, VarhubSwitchParameterProps} from \"../parameter/VarhubSwitchParameter\";\r\n\r\n\r\nexport const SettingsSwitchParameter: FC<VarhubSwitchParameterProps> = (props) => {\r\n\r\n    return (\r\n        <VarhubSwitchParameter {...props} name={\"settings.\"+props.name}/>\r\n    )\r\n}","import {Controller, useFormContext} from \"react-hook-form\";\r\nimport {FC} from \"react\";\r\n\r\nimport \"./VarhubParameter.css\"\r\nimport {Switch} from \"../Switch/Switch\";\r\n\r\nexport interface VarhubSwitchParameterProps {\r\n    name: string;\r\n    label?: string;\r\n    className?: string;\r\n}\r\n\r\nexport const VarhubSwitchParameter: FC<VarhubSwitchParameterProps> = (props) => {\r\n    const {\r\n        name,\r\n        label = props.name,\r\n        className = \"vh-mt-3\"\r\n    } = props;\r\n    const {control, getValues} = useFormContext() // retrieve all hook methods\r\n\r\n    return (\r\n        <Controller\r\n            render={({field}) => <Switch className={className} onChange={field.onChange} value={field.value}>{label}</Switch>}\r\n            name={name}\r\n            defaultValue={getValues(name)||false}\r\n            shouldUnregister={true}\r\n            control={control}\r\n        />\r\n    )\r\n}","import {FC, PropsWithChildren, useCallback} from \"react\";\r\n\r\nimport \"./Switch.css\"\r\nimport cn from \"classnames\";\r\n\r\ninterface SwitchProps {\r\n    value?: boolean;\r\n    onChange?: (value: boolean) => void;\r\n    className?: string;\r\n}\r\n\r\nexport const Switch: FC<PropsWithChildren<SwitchProps>> = (props) => {\r\n    const {value, onChange, className, children} = props;\r\n\r\n    const onChangeCheckbox = useCallback((event) => {\r\n        onChange?.(event.target.checked);\r\n    }, [onChange])\r\n\r\n    return (\r\n        <label className={cn(\"vh-toggle\", className)}>\r\n            <span className=\"vh-toggle-label\">{children}</span>\r\n            <input className=\"vh-toggle-checkbox\" checked={value} onChange={onChangeCheckbox} type=\"checkbox\"/>\r\n            <div className=\"vh-toggle-switch\"></div>\r\n        </label>\r\n    )\r\n}","export * from \"./VarhubGameClientContext\""],"names":[],"version":3,"file":"index.js.map"}